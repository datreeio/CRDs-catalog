{
  "description": "DataPlaneControl is the Schema for the data plane controller API",
  "properties": {
    "apiVersion": {
      "description": "APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources",
      "type": "string"
    },
    "kind": {
      "description": "Kind is a string value representing the REST resource this object represents. Servers may infer this from the endpoint the client submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds",
      "type": "string"
    },
    "metadata": {
      "type": "object"
    },
    "spec": {
      "description": "DataPlaneControlSpec defines the desired state of data plane revisions.",
      "properties": {
        "instanceUpgradeDurationHours": {
          "description": "InstanceUpgradeDurationHours is the duration for proxy upgrades. This controls the rate of evictions.",
          "format": "int32",
          "type": "integer"
        },
        "proxyTargetBasisPoints": {
          "description": "ProxyTargetBasisPoints is the basis points (1/10000) of proxies which should be at ProxyVersion. Only auto-injected proxies belonging to Deployments and ReplicaSets in the revision above are considered in the calculation. 0 means that the controller will not auto upgrade any proxy in the cluster. The actual value may vary depending on quantization due to the total number of proxies. Actual value will be rounded down to the nearest value, but never rounded to zero if positive.",
          "format": "int32",
          "type": "integer"
        },
        "proxyTargetBasisPointsTD": {
          "description": "ProxyTargetBasisPointsTD is the basis points (1/10000) of proxies which should be at ProxyVersionTD.",
          "format": "int32",
          "type": "integer"
        },
        "proxyVersion": {
          "description": "ProxyVersion is the target version of the proxy in the cluster.",
          "type": "string"
        },
        "proxyVersionTD": {
          "description": "ProxyVersionTD is the target version of the proxy in the cluster for TD.",
          "type": "string"
        },
        "revision": {
          "description": "Revision is the revision for this cluster entry. Clusters may have more than one revision.",
          "type": "string"
        },
        "servingMode": {
          "description": "ServingMode is the serving mode of the control plane. TODO(wonjekang): set this to the control plane in the AFC sync subcontroller.",
          "format": "int32",
          "type": "integer"
        },
        "upgradeDurationValidUntil": {
          "description": "UpgradeDurationValidUntil is the timestamp after which the instance upgrade duration becomes invalid.",
          "type": "string"
        }
      },
      "type": "object",
      "additionalProperties": false
    },
    "status": {
      "description": "DataPlaneControlStatus defines the observed state of data plane revisions.",
      "properties": {
        "errorDetails": {
          "description": "Error details if the state is an error",
          "properties": {
            "code": {
              "description": "Error code.",
              "format": "int32",
              "type": "integer"
            },
            "message": {
              "description": "Error message.",
              "type": "string"
            }
          },
          "type": "object",
          "additionalProperties": false
        },
        "observedGeneration": {
          "description": "The generation observed by the data plane controller.",
          "format": "int64",
          "type": "integer"
        },
        "proxyMetrics": {
          "description": "ProxyMetrics shows the overall cluster proxy metrics.",
          "properties": {
            "managedProxyCount": {
              "description": "ManagedProxyCount is the number of proxies managed by the controller.",
              "format": "int32",
              "type": "integer"
            },
            "namespacesEnabledCount": {
              "description": "NamespacesEnabledCount is the number of namespaces that have MDP enabled.",
              "format": "int32",
              "type": "integer"
            },
            "podsEnabledCount": {
              "description": "PodsEnabledCount is the number of pods that have MDP enabled.",
              "format": "int32",
              "type": "integer"
            },
            "unManagedProxyCount": {
              "description": "UnmanagedProxyCount is the number of proxies NOT managed by the controller.",
              "format": "int32",
              "type": "integer"
            }
          },
          "type": "object",
          "additionalProperties": false
        },
        "proxyTargetBasisPoints": {
          "description": "ProxyTargetBasisPoints is the actual basis points of proxies at the target version. -1 means unknown.",
          "format": "int32",
          "type": "integer"
        },
        "proxyTargetBasisPointsTD": {
          "description": "ProxyTargetBasisPoints is the actual basis points of proxies at the target version for TD. -1 means unknown.",
          "format": "int32",
          "type": "integer"
        },
        "state": {
          "description": "Current state of the controller.",
          "type": "string"
        }
      },
      "required": [
        "state"
      ],
      "type": "object",
      "additionalProperties": false
    }
  },
  "type": "object"
}
